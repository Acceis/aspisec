<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Aspisec::Clean
  
    &mdash; Documentation by YARD 0.9.36
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Aspisec::Clean";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Aspisec.html" title="Aspisec (module)">Aspisec</a></span></span>
     &raquo; 
    <span class="title">Clean</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Aspisec::Clean
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Aspisec::Clean</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib-ruby/aspisec/clean.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Manage the cleaning operations</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clean-instance_method" title="#clean (instance method)">#<strong>clean</strong>  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Main method, handling the cleaning.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_location-instance_method" title="#delete_location (instance method)">#<strong>delete_location</strong>(path)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Handles and logs deletion of locations.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_mode-instance_method" title="#delete_mode (instance method)">#<strong>delete_mode</strong>(loc)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Handles the deletion mode.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#directory_size-instance_method" title="#directory_size (instance method)">#<strong>directory_size</strong>(path)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Calculate directory size (size of all files stored in it).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_type-instance_method" title="#file_type (instance method)">#<strong>file_type</strong>(path)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Type of file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#human_size-instance_method" title="#human_size (instance method)">#<strong>human_size</strong>(size)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Formats number as bytes into a human-friendly representation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(conf: nil, logger: nil)  &#x21d2; Clean </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Clean.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#manual_delete-instance_method" title="#manual_delete (instance method)">#<strong>manual_delete</strong>(loc)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Handles the manual deletion mode.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prompt_removal-instance_method" title="#prompt_removal (instance method)">#<strong>prompt_removal</strong>(location:)  &#x21d2; true|false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Display location (file or directory) information and prompt user for deletion It will follow the configuration wether it has to display the description or not.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#puts_decorated-instance_method" title="#puts_decorated (instance method)">#<strong>puts_decorated</strong>(key, value)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Display decorated key/value.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type_delete-instance_method" title="#type_delete (instance method)">#<strong>type_delete</strong>(path)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Delete the location regardless of whether it is a file or a directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type_size-instance_method" title="#type_size (instance method)">#<strong>type_size</strong>(path)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Displays the size (in human-friendly format with <span class='object_link'><a href="#human_size-instance_method" title="Aspisec::Clean#human_size (method)">#human_size</a></span>) regardless of whether it is a file or a directory.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(conf: nil, logger: nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Aspisec::Clean (class)">Clean</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Clean.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>conf</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Config.html" title="Aspisec::Config (class)">Aspisec::Config</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>an instance of the global configuration
If none is provided, the default config is loaded.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>logger</span>
      
      
        <span class='type'>(<tt>TTY::Logger</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>logger instance. See <span class='object_link'><a href="Logger.html" title="Aspisec::Logger (class)">Logger</a></span>.
If none is provided, a default logger with log level 2 is created.
See <span class='object_link'><a href="Logger.html#LOG_LEVEL-constant" title="Aspisec::Logger::LOG_LEVEL (constant)">Logger::LOG_LEVEL</a></span>.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 18</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(<span style="color:#606">conf</span>: <span style="color:#069">nil</span>, <span style="color:#606">logger</span>: <span style="color:#069">nil</span>)
  <span style="color:#33B">@logger</span> = logger || <span style="color:#036;font-weight:bold">Aspisec</span>::<span style="color:#036;font-weight:bold">Logger</span>.new.logger
  <span style="color:#33B">@conf</span> = conf || <span style="color:#036;font-weight:bold">Aspisec</span>::<span style="color:#036;font-weight:bold">Config</span>.new(<span style="color:#33B">@logger</span>).conf
  <span style="color:#33B">@modules</span> = <span style="color:#036;font-weight:bold">Aspisec</span>::<span style="color:#036;font-weight:bold">Modules</span>.modules(<span style="color:#606">conf</span>:, <span style="color:#606">logger</span>:).select(&amp;<span style="color:#A60">:enabled?</span>)
  <span style="color:#33B">@autoclean</span> = <span style="color:#33B">@conf</span>.dig(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">aspisec</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">autoclean</span><span style="color:#710">'</span></span>).fetch(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">enabled</span><span style="color:#710">'</span></span>, <span style="color:#069">false</span>)
  <span style="color:#33B">@describe</span> = <span style="color:#33B">@conf</span>.dig(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">aspisec</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">describe</span><span style="color:#710">'</span></span>).fetch(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">enabled</span><span style="color:#710">'</span></span>, <span style="color:#069">true</span>)
  <span style="color:#33B">@prompt</span> = <span style="color:#036;font-weight:bold">TTY</span>::<span style="color:#036;font-weight:bold">Prompt</span>.new
  <span style="color:#33B">@painter</span> = <span style="color:#036;font-weight:bold">Pastel</span>.new(<span style="color:#606">eachline</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clean-instance_method">
  
    #<strong>clean</strong>  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Main method, handling the cleaning.
Only enabled modules and locations will be removed.
Works either with auto-cleaning or ask for manual confirmation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 140</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">clean</span>
  <span style="color:#33B">@modules</span>.each <span style="color:#080;font-weight:bold">do</span> |mod|
    <span style="color:#080;font-weight:bold">next</span> <span style="color:#080;font-weight:bold">unless</span> mod.enabled?

    puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">━━━━━━━━━━━━ </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#33B">@painter</span>.decorate(mod.name, <span style="color:#A60">:white</span>, <span style="color:#A60">:bold</span>, <span style="color:#A60">:on_blue</span>)<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20"> ━━━━━━━━━━━━</span><span style="color:#710">&quot;</span></span>
    mod.locations.each <span style="color:#080;font-weight:bold">do</span> |loc|
      delete_mode(loc)
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#069">nil</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_location-instance_method">
  
    #<strong>delete_location</strong>(path)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Handles and logs deletion of locations</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Pathname</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 107</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">delete_location</span>(path)
  type_delete(path)
  <span style="color:#33B">@logger</span>.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>path<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20"> was removed</span><span style="color:#710">&quot;</span></span>)
  <span style="color:#069">nil</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_mode-instance_method">
  
    #<strong>delete_mode</strong>(loc)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Handles the deletion mode. It could be automatic or manual cleaning.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>loc</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Module/Location.html" title="Aspisec::Module::Location (class)">Aspisec::Module::Location</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 115</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">delete_mode</span>(loc)
  <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">unless</span> loc.enabled? &amp;&amp; loc.path.exist?

  <span style="color:#080;font-weight:bold">if</span> <span style="color:#33B">@autoclean</span>
    delete_location(loc.path)
  <span style="color:#080;font-weight:bold">else</span>
    manual_delete(loc)
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="directory_size-instance_method">
  
    #<strong>directory_size</strong>(path)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Calculate directory size (size of all files stored in it).
It will be the real size of files not the size on disk.
It ignores anything else than files so it could be wrong for symlinks, mounts, etc.
It also don't take into consideration the size of the directory itself.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Pathname</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>size in bytes</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 76</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">directory_size</span>(path)
  <span style="color:#036;font-weight:bold">Dir</span>[<span style="color:#036;font-weight:bold">File</span>.join(path, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">**</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">*</span><span style="color:#710">'</span></span>)].select { |f| <span style="color:#036;font-weight:bold">File</span>.file?(f) }.sum { |f| <span style="color:#036;font-weight:bold">File</span>.size(f) }
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="file_type-instance_method">
  
    #<strong>file_type</strong>(path)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Type of file</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Pathname</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p><code>file</code>, <code>directory</code> or <code>other</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 52</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">file_type</span>(path)
  <span style="color:#080;font-weight:bold">if</span> path.file?
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">file</span><span style="color:#710">'</span></span>
  <span style="color:#080;font-weight:bold">elsif</span> path.directory?
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">directory</span><span style="color:#710">'</span></span>
  <span style="color:#080;font-weight:bold">else</span>
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">other</span><span style="color:#710">'</span></span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="human_size-instance_method">
  
    #<strong>human_size</strong>(size)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Formats number as bytes into a human-friendly representation.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>size</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>file size in bytes</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>human-friendly size with the most suitable unit</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html#method-i-number_to_human_size" target="_parent" title="https://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html#method-i-number_to_human_size">https://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html#method-i-number_to_human_size</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 66</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">human_size</span>(size)
  <span style="color:#036;font-weight:bold">ActiveSupport</span>::<span style="color:#036;font-weight:bold">NumberHelper</span>.number_to_human_size(size)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="manual_delete-instance_method">
  
    #<strong>manual_delete</strong>(loc)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Handles the manual deletion mode.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>loc</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Module/Location.html" title="Aspisec::Module::Location (class)">Aspisec::Module::Location</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 127</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">manual_delete</span>(loc)
  remove = prompt_removal(<span style="color:#606">location</span>: loc)
  <span style="color:#080;font-weight:bold">if</span> remove
    delete_location(loc.path)
  <span style="color:#080;font-weight:bold">else</span>
    <span style="color:#33B">@logger</span>.debug(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>loc.path<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20"> was left untouched</span><span style="color:#710">&quot;</span></span>)
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prompt_removal-instance_method">
  
    #<strong>prompt_removal</strong>(location:)  &#x21d2; <tt>true|false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Display location (file or directory) information and prompt user for deletion
It will follow the configuration wether it has to display the description or not.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>location</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Module/Location.html" title="Aspisec::Module::Location (class)">Aspisec::Module::Location</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true|false</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 32</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">prompt_removal</span>(<span style="color:#606">location</span>:)
  puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">——— </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#33B">@painter</span>.decorate(location.name, <span style="color:#A60">:cyan</span>, <span style="color:#A60">:bold</span>)<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20"> ———</span><span style="color:#710">&quot;</span></span>
  puts_decorated(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Path</span><span style="color:#710">'</span></span>, location.path.to_s)
  puts_decorated(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Type</span><span style="color:#710">'</span></span>, file_type(location.path))
  puts_decorated(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Size</span><span style="color:#710">'</span></span>, type_size(location.path))
  puts_decorated(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Description</span><span style="color:#710">'</span></span>, location.description) <span style="color:#080;font-weight:bold">if</span> <span style="color:#33B">@describe</span>
  <span style="color:#33B">@prompt</span>.yes?(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Do you want to remove </span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>location.name<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20">?</span><span style="color:#710">&quot;</span></span>)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="puts_decorated-instance_method">
  
    #<strong>puts_decorated</strong>(key, value)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Display decorated key/value</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 45</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">puts_decorated</span>(key, value)
  puts <span style="color:#33B">@painter</span>.decorate(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span>key<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20">: </span><span style="color:#710">&quot;</span></span>, <span style="color:#A60">:bright_blue</span>, <span style="color:#A60">:bold</span>) + value
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type_delete-instance_method">
  
    #<strong>type_delete</strong>(path)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Delete the location regardless of whether it is a file or a directory.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Pathname</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 95</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">type_delete</span>(path)
  <span style="color:#080;font-weight:bold">if</span> path.directory?
    path.rmtree
  <span style="color:#080;font-weight:bold">else</span>
    path.delete
  <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#069">nil</span>
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type_size-instance_method">
  
    #<strong>type_size</strong>(path)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Displays the size (in human-friendly format with <span class='object_link'><a href="#human_size-instance_method" title="Aspisec::Clean#human_size (method)">#human_size</a></span>) regardless of whether it is a file or a directory.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Pathname</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>human-friendly size with the most suitable unit, or <code>empty</code> is the size is zero</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib-ruby/aspisec/clean.rb', line 83</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">type_size</span>(path)
  size = <span style="color:#080;font-weight:bold">if</span> path.directory?
           directory_size(path)
         <span style="color:#080;font-weight:bold">else</span>
           path.size
         <span style="color:#080;font-weight:bold">end</span>
  size.zero? ? <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">empty</span><span style="color:#710">'</span></span> : human_size(size)
<span style="color:#080;font-weight:bold">end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Apr  8 17:21:48 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.36 (ruby-3.3.0).
</div>

    </div>
  </body>
</html>